{"version":3,"sources":["../src/readaloudhighcharts.js"],"names":["define","$","config","Str","hcGlobal","courseId","classId","classType","strings","tooltipContent","formatter","str","point","isDrillDown","isUserChart","label","photoUrl","name","clickformore","drawChart","containerId","dataSeries","yAxisLabel","drilldownSeries","chartType","chartParams","chart","type","title","text","useHTML","xAxis","labels","rotation","style","fontSize","fontFamily","width","whiteSpace","color","yAxis","min","plotLines","legend","floating","layout","align","verticalAlign","x","y","tooltip","backgroundColor","borderColor","borderRadius","borderWidth","series","plotOptions","cursor","states","hover","enabled","showInLegend","events","click","e","location","href","wwwroot","xid","drilldown","photo","setTitle","drillup","seriesOptions","benchmarks","attr","JSON","parse","benchmarkssubtitle","forEach","bench","value","push","dashStyle","zIndex","wpm","subtitle","max","get_primary_dataseries","userOnly","dataDivs","not","map","index","div","id","chartclass","seriestype","json","each","get_secondary_dataseries","data","fillColor","init","courseIdInit","theKlass","require","packages","main","paths","highcharts","Highcharts","ExportingModule","AccessibilityModule","Drilldown","document","ready","get_strings","key","component","done","result","percent","readingscompleted","primaryDataSeries","drillDownSeries","wordsperminute","accuracy","quiz"],"mappings":"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","sourcesContent":["define(['jquery', 'core/config', 'core/str'],\n    function($, config, Str) {\n    \"use strict\";\n\n    var hcGlobal;\n    var courseId;\n    var classId;\n    var classType;\n\n    var strings = {};\n    var fontFamily = '\"Open Sans\",-apple-system,BlinkMacSystemFont,\"Segoe UI\",' +\n        'Roboto,\"Helvetica Neue\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\"';\n\n    /**\n     * When the user hovers over a bar, we show the bar details and learner photo.\n     * @param formatter\n     * @returns {string}\n     */\n    var tooltipContent = function(formatter) {\n        var str = '';\n        if (formatter.point.isDrillDown || formatter.point.isUserChart) {\n            str += '<div class=\"text-center mt-1\">' + formatter.point.label + '</div>';\n        } else {\n                str += '<div class=\"text-center mt-1\">' +\n                    '<img src=\"' + formatter.point.photoUrl\n                    + '\" class=\"userpicture defaultuserpic\" role=\"presentation\" width=\"50\" height=\"50\">' + '</div>'\n                    + '<div class=\"text-center mt-1\">' + formatter.point.name + '</div>'\n                    + '<div class=\"text-center mt-1\">' + formatter.point.label + '</div>';\n            str += '<div class=\"text-center mt-1\">' + strings.clickformore + '</div>';\n        }\n        return str;\n    };\n\n    /**\n     * Draw the chart in the specified container, based on the data series and optional drilldown data series.\n     * @param containerId\n     * @param dataSeries\n     * @param yAxisLabel\n     * @param drilldownSeries\n     * @param chartType\n     */\n    var drawChart = function(containerId, dataSeries, yAxisLabel, drilldownSeries, chartType) {\n        var chartParams = {\n            chart: {\n                type: chartType === undefined ? 'column' : chartType\n            },\n            title: {text: dataSeries[0].name, useHTML: true},\n            xAxis: {\n                type: 'category', labels: {\n                    rotation: 90,\n                    style: {\n                        fontSize: '11px',\n                        fontFamily: fontFamily,\n                        width: '200px',\n                        whiteSpace: 'nowrap',\n                        color: '#898989'\n                    },\n                },\n            },\n            yAxis: {min: 0, title: {text: yAxisLabel}, plotLines: []},\n            legend: {\n                floating: true,\n                layout: 'vertical',\n                align: 'left',\n                verticalAlign: 'top',\n                x: 60,\n                y: 0\n            },\n            tooltip: {\n                useHTML: true,\n                backgroundColor: '#f5f5f5',\n                borderColor: '#8c8c8c',\n                borderRadius: 10,\n                borderWidth: 2,\n                formatter: function() {\n                    return tooltipContent(this);\n                }\n            },\n            series: dataSeries, // this includes both sets of data if we have both bars and points on the chart.\n            plotOptions: {series: {cursor: 'pointer', states: {hover: {enabled: false}}}, showInLegend: 0}\n        };\n\n        if (chartType === 'readingscompleted') {\n            chartParams.plotOptions.series.point = {\n                events: {\n                    click: function (e) {\n                        location.href = config.wwwroot + '/blocks/readaloudteacher/klasses/userreports.php?userid='\n                            + e.point.xid + '&courseid=' + courseId + \"&returnklassid=\" + classId + \"&returnklasstype=\" + classType;\n                    }\n                }\n            };\n        } else if (drilldownSeries !== undefined && drilldownSeries) {\n            chartParams.drilldown = {series: drilldownSeries, type: 'line'};\n            chartParams.chart.events = {\n                drilldown: function (e) {\n                    var photo = '<img src=\"'\n                        + e.point.photoUrl + '\" class=\"userpicture defaultuserpic\" role=\"presentation\" width=\"50\" height=\"50\">';\n                    this.setTitle({text: photo + e.point.name});\n                },\n                drillup: function (e) {\n                    this.setTitle({text: e.seriesOptions.name});\n                }\n            };\n        }\n        if (chartType === 'wpm') {\n            var benchmarks = $(\"#pagedata\").attr(\"data-wpmbenchmarks\");\n            if (benchmarks !== undefined) {\n                benchmarks = JSON.parse(benchmarks);\n                var benchmarkssubtitle = '<b>' + strings.benchmarks + '</b>: ';\n                benchmarks.forEach(function(bench) {\n                    if (bench.value !== \"0\") {\n                        chartParams.yAxis.plotLines.push({\n                            color: 'lightblue',\n                            value: bench.value,\n                            dashStyle: 'dash',\n                            width: '2',\n                            zIndex: 5,\n                            label: {text: bench.name,  align: 'right', x: -5}\n                        });\n                        benchmarkssubtitle += bench.name + ' ' + bench.value + ' ' + strings.wpm + ' | ';\n                    }\n                });\n                chartParams.subtitle = {text: benchmarkssubtitle};\n            }\n        }\n        if (chartType === 'quiz' || chartType === 'accuracy') {\n            // Tjhese are percentage charts.\n            chartParams.yAxis.max = 100;\n        }\n        hcGlobal.chart(containerId, chartParams);\n    };\n\n    /**\n     * Get the primary data for the charts on this page from the PHP page (JSON).\n     * @returns {[]}\n     */\n    var get_primary_dataseries = function(userOnly) {\n        var dataSeries = [];\n        var dataDivs = $(\".highcharts-data\").not(\".drilldown-dataseries\").map(function(index, div) {\n            div = $(div);\n            return div !== undefined && div.attr('data-highcharts-data') !== undefined\n                ? {\n                    id: div.attr('id'),\n                    chartclass: div.attr('data-chart-class'),\n                    seriestype: div.attr('data-series-type'),\n                    json: JSON.parse(div.attr('data-highcharts-data'))\n                } : {};\n        });\n        dataDivs.each(function(index, div) {\n            if (div.chartclass === 'readingscompleted' || userOnly) {\n                dataSeries[div.chartclass] = div;\n            } else {\n                dataSeries[div.chartclass + '-' + div.seriestype] = div;\n            }\n        });\n        return dataSeries;\n    };\n\n    /**\n     * Get the secondary (drilldown) data for the charts on this page from the PHP page (JSON).\n     * @returns {[]}\n     */\n    var get_secondary_dataseries = function() {\n        var dataSeries = [];\n        var dataDivs = $(\".drilldown-dataseries\").map(function(index, div) {\n            div = $(div);\n            return div !== undefined && div.attr('data-highcharts-data') !== undefined\n                ? {\n                    id: div.attr('id'),\n                    chartclass: div.attr('data-chart-class'),\n                    data: JSON.parse(div.attr('data-highcharts-data'))\n                } : {};\n        });\n        dataDivs.each(function(index, div) {\n            if (div.chartclass !== 'readingscompleted') {\n                if (dataSeries[div.chartclass] === undefined) {\n                    dataSeries[div.chartclass] = [];\n                }\n                dataSeries[div.chartclass].push({\n                    id: div.id,\n                    type: div.data.type,\n                    name: div.data.name,\n                    data: div.data.data,\n                    fillColor: div.data.fillColor,\n                    // yaxis: {min: Math.round(0.75 * Math.max.apply(Math, div.data.data.map(function(elem){return elem.y;})))}\n                });\n            }\n        });\n        return dataSeries;\n    };\n\n    return {\n        init: function(courseIdInit, theKlass, userOnly) {\n\n            require.config({\n                packages: [{\n                    name: 'highcharts',\n                    main: 'highcharts'\n                }],\n                paths: {\n                    highcharts: config.wwwroot + '/blocks/readaloudteacher/plugins/highcharts/code'\n                }\n            });\n            courseId = courseIdInit;\n            classId = theKlass.id;\n            classType = theKlass.type;\n\n            // Load the dependencies for highcharts.\n            require(\n                [\n                    'highcharts',\n                    'highcharts/modules/exporting',\n                    'highcharts/modules/accessibility',\n                    'highcharts/modules/drilldown'\n                ],\n\n                // This function runs when the above files have been loaded.\n                function(Highcharts, ExportingModule, AccessibilityModule, Drilldown) {\n\n                    hcGlobal = Highcharts;\n\n                    $(document).ready(function() {\n                        // We need to initialize module files and pass in Highcharts.\n                        ExportingModule(Highcharts);\n                        AccessibilityModule(Highcharts);\n                        Drilldown(Highcharts);\n\n                        Str.get_strings([\n                            {key:  'clickformore', component: 'block_readaloudteacher'},\n                            {key:  'percent', component: 'block_readaloudteacher'},\n                            {key:  'colwpm', component: 'block_readaloudteacher'},\n                            {key:  'readingscompleted', component: 'block_readaloudteacher'},\n                            {key:  'benchmarks', component: 'block_readaloudteacher'}\n                        ]).done(function(result) {\n                            strings.clickformore = result[0];\n                            strings.percent = result[1];\n                            strings.wpm = result[2];\n                            strings.readingscompleted = result[3];\n                            strings.benchmarks = result[4];\n\n                            // First the primary data series (not drilldown data).\n                            var primaryDataSeries = get_primary_dataseries(userOnly);\n\n                            if (!userOnly) {\n\n                                // We are doing a class report (not user) - they have drilldown data on users.\n                                var drillDownSeries = get_secondary_dataseries();\n\n                                // They also have a readings completed by user chart first.\n                                drawChart(\n                                    'highchart-readings-completed',\n                                    [primaryDataSeries.readingscompleted.json],\n                                    strings.readingscompleted,\n                                    [],\n                                    'readingscompleted'\n                                );\n\n                                drawChart(\n                                    'highchart-wpm',\n                                    [\n                                        primaryDataSeries['wordsperminute-average'].json,\n                                        primaryDataSeries['wordsperminute-latest'].json\n                                    ],\n                                    strings.wpm,\n                                    drillDownSeries.wordsperminute,\n                                    'wpm'\n                                );\n\n                                drawChart(\n                                    'highchart-accuracy',\n                                    [primaryDataSeries['accuracy-average'].json, primaryDataSeries['accuracy-latest'].json],\n                                    strings.percent,\n                                    drillDownSeries.accuracy,\n                                    'accuracy'\n                                );\n\n                                drawChart(\n                                    'highchart-quiz',\n                                    [primaryDataSeries['quiz-average'].json, primaryDataSeries['quiz-latest'].json],\n                                    strings.percent,\n                                    drillDownSeries.quiz,\n                                    'quiz'\n                                );\n\n                            } else {\n                                // We are doing charts for one user only.\n                                drawChart(\n                                    'highchart-wpm',\n                                    [primaryDataSeries.wordsperminute.json],\n                                    strings.wpm,\n                                    [],\n                                    'wpm'\n                                );\n                                drawChart(\n                                    'highchart-quiz',\n                                    [primaryDataSeries.quiz.json],\n                                    strings.percent,\n                                    [],\n                                    'quiz'\n                                );\n                                drawChart(\n                                    'highchart-accuracy',\n                                    [primaryDataSeries.accuracy.json],\n                                    strings.percent,\n                                    [],\n                                    'accuracy'\n                                );\n                            }\n                        });\n                    });\n                }\n            );\n        }\n    };\n});"],"file":"readaloudhighcharts.min.js"}